"use strict";(self.webpackChunkmaskito=self.webpackChunkmaskito||[]).push([[2905],{2905:(C,S,d)=>{d.d(S,{U5:()=>f}),d(9510),d(7258);var g=d(4788);let f=(()=>{class r{}return r.\u0275fac=function(_){return new(_||r)},r.\u0275mod=g.oAB({type:r}),r.\u0275inj=g.cJS({}),r})();d(635)},9510:(C,S,d)=>{d.d(S,{F:()=>f});var v=d(3738),k=d(7383),g=d(4788);let f=(()=>{class E{constructor(h){this.accessor=h,this.maskito=k.A_;const _=h.writeValue.bind(h);h.writeValue=M=>{_((0,k.CV)(String(null!=M?M:""),this.maskito))}}}return E.\u0275fac=function(h){return new(h||E)(g.Y36(v.Fj))},E.\u0275dir=g.lG2({type:E,selectors:[["input","maskito",""],["textarea","maskito",""]],hostBindings:function(h,_){1&h&&g.NdJ("input",function(w){return _.accessor._handleInput(w.target.value)})("blur",function(){return _.accessor.onTouched()})("compositionstart",function(){return _.accessor._compositionStart()})("compositionend",function(w){return _.accessor._compositionEnd(w.target.value)})},inputs:{maskito:"maskito"},features:[g._Bn([v.Fj,{provide:v.JU,multi:!0,useExisting:v.Fj}])]}),E})()},7258:(C,S,d)=>{d.d(S,{r:()=>g});var v=d(4788),k=d(7383);let g=(()=>{class f{constructor(r){this.elementRef=r,this.maskedElement=null,this.maskito=k.A_,this.maskitoElement=h=>h.querySelector("input,textarea")||h}ngOnChanges(){var r;null===(r=this.maskedElement)||void 0===r||r.destroy(),this.maskedElement=new k.C8(this.maskitoElement(this.elementRef.nativeElement),this.maskito)}ngOnDestroy(){var r;null===(r=this.maskedElement)||void 0===r||r.destroy()}}return f.\u0275fac=function(r){return new(r||f)(v.Y36(v.SBq))},f.\u0275dir=v.lG2({type:f,selectors:[["","maskito",""]],inputs:{maskito:"maskito",maskitoElement:"maskitoElement"},features:[v.TTD]}),f})()},635:(C,S,d)=>{d.d(S,{c:()=>g});var v=d(7383),k=d(4788);let g=(()=>{class f{transform(r,h){return(0,v.CV)(String(null!=r?r:""),h)}}return f.\u0275fac=function(r){return new(r||f)},f.\u0275pipe=k.Yjl({name:"maskito",type:f,pure:!0}),f})()},7383:(C,S,d)=>{function v(i){return i}d.d(S,{A_:()=>k,C8:()=>U,Zu:()=>K,CV:()=>L});const k={mask:/^.*$/,preprocessor:v,postprocessor:v,overwriteMode:"shift"};function h(i){return"string"==typeof i}function _(i,e,s,t){let n="";for(let o=e.length;o<i.length;o++){const a=i[o],l=(null==t?void 0:t.value[o])===a;if(!h(a)||a===s&&!l)return n;n+=a}return n}function M(i,e){return Array.isArray(e)?i.length===e.length&&Array.from(i).every((s,t)=>{const n=e[t];return h(n)?s===n:s.match(n)}):e.test(i)}function T(i,e,s=null){if(M(i.value,e))return i;const{value:t,selection:n}=Array.isArray(e)?function(i,e,s){let t=null,n=null;const o=Array.from(i.value).reduce((l,c,p)=>{const m=l+_(e,l,c,s),y=e[m.length];return h(y)?m+y:c.match(y)?(null===t&&p>=i.selection[0]&&(t=m.length),null===n&&p>=i.selection[1]&&(n=m.length),m+c):m},""),a=_(e,o,"",s);return{value:M(o+a,e)?o+a:o,selection:[null!=t?t:o.length,null!=n?n:o.length]}}(i,e,s):function({value:i,selection:e},s){const[t,n]=e;let o=t,a=n;return{value:Array.from(i).reduce((c,p,u)=>{const m=c+p;return t===u&&(o=c.length),n===u&&(a=c.length),m.match(s)?m:c},""),selection:[o,a]}}(i,e);return{selection:n,value:Array.isArray(e)?t.slice(0,e.length):t}}function A(i,e){if(!Array.isArray(e))return i;const[s,t]=i.selection,n=[],o=Array.from(i.value).reduce((a,l,c)=>{const p=e[c];return c===s&&n.push(a.length),c===t&&n.push(a.length),h(p)&&p===l?a:a+l},"");return n.length<2&&n.push(...Array(2-n.length).fill(o.length)),{value:o,selection:[n[0],n[1]]}}class D{constructor(e,s){this.initialElementState=e,this.maskOptions=s,this.value="",this.selection=[0,0];const{value:t,selection:n}=T(e,this.getMaskExpression(e));this.value=t,this.selection=n}addCharacters([e,s],t){const{value:n}=this,o=this.getMaskExpression({value:n.slice(0,e)+t+n.slice(s),selection:[e+t.length,e+t.length]}),a={value:n,selection:[e,s]},l=A(a,o),[c,p]=function({value:i,selection:e},s,t){const[n,o]=e;return{value:i,selection:"replace"===("function"==typeof t?t({value:i,selection:e}):t)?[n,n+s.length]:[n,o]}}(l,t,this.maskOptions.overwriteMode).selection,u=l.value.slice(0,c)+t,m=u.length,y=T({value:u+l.value.slice(p),selection:[m,m]},o,a);if(n.slice(0,c)===T({value:u,selection:[m,m]},o,a).value||function(i,...e){return e.every(({value:s,selection:t})=>s===i.value&&t[0]===i.selection[0]&&t[1]===i.selection[1])}(this,y))throw new Error("Invalid mask value");this.value=y.value,this.selection=y.selection}deleteCharacters([e,s]){if(e===s||!s)return;const{value:t}=this,n=this.getMaskExpression({value:t.slice(0,e)+t.slice(s),selection:[e,e]}),o={value:t,selection:[e,s]},a=A(o,n),[l,c]=a.selection,u=T({value:a.value.slice(0,l)+a.value.slice(c),selection:[l,l]},n,o);this.value=u.value,this.selection=u.selection}getMaskExpression(e){const{mask:s}=this.maskOptions;return"function"==typeof s?s(e):s}}class b{constructor(e){this.element=e,this.listeners=[]}listen(e,s,t){const n=s;this.element.addEventListener(e,n,t),this.listeners.push(()=>this.element.removeEventListener(e,n))}destroy(){this.listeners.forEach(e=>e())}}function R({value:i,selection:e},s){const[t,n]=e;if(t!==n)return[t,n];const o=s?i.slice(t).indexOf("\n")+1||i.length:i.slice(0,n).lastIndexOf("\n")+1;return[s?t:o,s?o:n]}function F({value:i,selection:e},s){const[t,n]=e;return t!==n?[t,n]:(s?[t,n+1]:[t-1,n]).map(a=>Math.min(Math.max(a,0),i.length))}const O=/\s+$/g,B=/^\s+/g,I=/\s/;function H({value:i,selection:e},s){const[t,n]=e;if(t!==n)return[t,n];if(s){const c=i.slice(t),[p]=c.match(B)||[""],u=c.replace(B,"").search(I);return[t,-1!==u?t+p.length+u:i.length]}const o=i.slice(0,n),[a]=o.match(O)||[""],l=o.replace(O,"").split("").reverse().findIndex(c=>c.match(I));return[-1!==l?n-a.length-l:0,n]}function K(...i){return(e,...s)=>i.reduce((t,n)=>Object.assign(Object.assign({},t),n(t,...s)),e)}function L(i,e){const s=Object.assign(Object.assign({},k),e),t="string"==typeof i?{value:i,selection:[0,0]}:i,{elementState:n}=s.preprocessor({elementState:t,data:""},"validation"),o=new D(n,s),{value:a,selection:l}=s.postprocessor(o,t);return"string"==typeof i?a:{value:a,selection:l}}class U extends class{constructor(){this.now=null,this.past=[],this.future=[]}undo(){const e=this.past.pop();e&&this.now&&(this.future.push(this.now),this.updateElement(e,"historyUndo"))}redo(){const e=this.future.pop();e&&this.now&&(this.past.push(this.now),this.updateElement(e,"historyRedo"))}updateHistory(e){if(!this.now)return void(this.now=e);const s=this.now.value!==e.value,t=this.now.selection.some((n,o)=>n!==e.selection[o]);!s&&!t||(s&&(this.past.push(this.now),this.future=[]),this.now=e)}updateElement(e,s){this.now=e,this.updateElementState(e,{inputType:s,data:null})}}{constructor(e,s){super(),this.element=e,this.maskitoOptions=s,this.eventListener=new b(this.element),this.options=Object.assign(Object.assign({},k),this.maskitoOptions),this.ensureValueFitsMask(),this.updateHistory(this.elementState),this.eventListener.listen("keydown",t=>{const{ctrlKey:n,key:o,metaKey:a,shiftKey:l}=t;return a&&l&&"z"===o||n&&"y"===o?(t.preventDefault(),this.redo()):(n||a)&&"z"===o?(t.preventDefault(),this.undo()):void 0}),"onbeforeinput"in e?this.eventListener.listen("beforeinput",t=>{const n=t.inputType.includes("Forward");switch(this.updateHistory(this.elementState),t.inputType){case"historyUndo":return t.preventDefault(),this.undo();case"historyRedo":return t.preventDefault(),this.redo();case"deleteByCut":case"deleteContentBackward":case"deleteContentForward":return this.handleDelete({event:t,isForward:n,selection:F(this.elementState,n)});case"deleteWordForward":case"deleteWordBackward":return this.handleDelete({event:t,isForward:n,selection:H(this.elementState,n),force:!0});case"deleteSoftLineBackward":case"deleteSoftLineForward":case"deleteHardLineBackward":case"deleteHardLineForward":return this.handleDelete({event:t,isForward:n,selection:R(this.elementState,n),force:!0});case"insertFromDrop":return;case"insertLineBreak":return this.handleEnter(t);case"insertFromPaste":case"insertText":default:return this.handleInsert(t,t.data||"")}}):(this.eventListener.listen("keydown",t=>this.handleKeydown(t)),this.eventListener.listen("paste",t=>{var n;return this.handleInsert(t,(null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text/plain"))||"")})),this.eventListener.listen("input",()=>{this.ensureValueFitsMask(),this.updateHistory(this.elementState)})}get elementState(){const{value:e,selectionStart:s,selectionEnd:t}=this.element;return{value:e,selection:[s||0,t||0]}}get isTextArea(){return"TEXTAREA"===this.element.nodeName}destroy(){this.eventListener.destroy()}updateElementState({value:e,selection:s},t={inputType:"insertText",data:null}){const n=this.elementState.value;this.updateValue(e),this.updateSelectionRange(s),n!==e&&this.dispatchInputEvent(t)}handleKeydown(e){const s=e.key,t="Delete"===s;switch(s){case"Backspace":case"Delete":return this.handleDelete({event:e,isForward:t,selection:F(this.elementState,t)});case"Enter":return this.handleEnter(e)}!function({key:i,ctrlKey:e,metaKey:s,altKey:t}){const n=e||s||t,o=/^.$/u.test(i);return!n&&"Backspace"!==i&&o}(e)||this.handleInsert(e,s)}ensureValueFitsMask(){this.updateElementState(L(this.elementState,this.options))}handleDelete({event:e,selection:s,isForward:t,force:n=!1}){const o={value:this.elementState.value,selection:s},[a,l]=o.selection,{elementState:c}=this.options.preprocessor({elementState:o,data:""},t?"deleteForward":"deleteBackward"),p=new D(c,this.options),[u,m]=c.selection;p.deleteCharacters([u,m]);const y=this.options.postprocessor(p,o);if(o.value.slice(0,a)+o.value.slice(l)!==y.value||n)return e.preventDefault(),function(i,...e){return e.every(({value:s})=>s===i.value)}(o,c,p,y)?this.updateSelectionRange(t?[m,m]:[u,u]):(this.updateElementState(y,{inputType:"inputType"in e?e.inputType:t?"deleteContentForward":"deleteContentBackward",data:null}),void this.updateHistory(y))}handleInsert(e,s){const t=this.elementState,{elementState:n,data:o=s}=this.options.preprocessor({data:s,elementState:t},"insert"),a=new D(n,this.options);try{a.addCharacters(n.selection,o)}catch(m){return e.preventDefault()}const[l,c]=n.selection,p=n.value.slice(0,l)+s+n.value.slice(c),u=this.options.postprocessor(a,t);p!==u.value&&(e.preventDefault(),this.updateElementState(u,{data:s,inputType:"inputType"in e?e.inputType:"insertText"}),this.updateHistory(u))}handleEnter(e){this.isTextArea&&this.handleInsert(e,"\n")}updateSelectionRange([e,s]){var t,n;(this.element.selectionStart!==e||this.element.selectionEnd!==s)&&(null===(n=(t=this.element).setSelectionRange)||void 0===n||n.call(t,e,s))}updateValue(e){this.element.value!==e&&(this.element.value=e)}dispatchInputEvent(e={inputType:"insertText",data:null}){const s="undefined"!=typeof window?window:globalThis;(null==s?void 0:s.InputEvent)&&this.element.dispatchEvent(new InputEvent("input",Object.assign(Object.assign({},e),{bubbles:!0,cancelable:!1})))}}}}]);