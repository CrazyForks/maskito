"use strict";(self.webpackChunkmaskito=self.webpackChunkmaskito||[]).push([[2905],{2905:(D,g,c)=>{c.d(g,{U5:()=>M}),c(7258);var E=c(4788);let M=(()=>{class h{}return h.\u0275fac=function(k){return new(k||h)},h.\u0275mod=E.oAB({type:h}),h.\u0275inj=E.cJS({}),h})()},3014:(D,g,c)=>{c.d(g,{v:()=>M});var v=c(2298),E=c(4788);let M=(()=>{class h extends v.t{constructor(){super(1)}set options(k){this.next(k)}}return h.\u0275fac=function(k){return new(k||h)},h.\u0275dir=E.lG2({type:h,selectors:[["","maskito","",5,"input",5,"textarea"]],inputs:{options:["maskito","options"]},features:[E.qOj]}),h})()},7258:(D,g,c)=>{c.d(g,{r:()=>k});var v=c(4788),E=c(3533),M=c(9765),h=c(6782),_=c(3014);let k=(()=>{class y{constructor(p,f){this.elementRef=p,this.externalOptions$=f,this.destroy$=new M.xQ,this.maskedElement=null}set options(p){var f;this.destroy$.next(),p?this.setup(p):null===(f=this.externalOptions$)||void 0===f||f.pipe((0,h.R)(this.destroy$)).subscribe(T=>this.setup(T))}ngOnDestroy(){var p;this.destroy$.next(),null===(p=this.maskedElement)||void 0===p||p.destroy()}setup(p){var f;null===(f=this.maskedElement)||void 0===f||f.destroy(),this.maskedElement=new E.C8(this.elementRef.nativeElement,p)}}return y.\u0275fac=function(p){return new(p||y)(v.Y36(v.SBq),v.Y36(_.v,8))},y.\u0275dir=v.lG2({type:y,selectors:[["input","maskito",""],["textarea","maskito",""]],inputs:{options:["maskito","options"]}}),y})()},3533:(D,g,c)=>{function v(i){return i}c.d(g,{C8:()=>L,Zu:()=>P});const E={mask:/^.*$/,preprocessor:v,postprocessor:v,overwriteMode:"shift"};function y(i){return"string"==typeof i}function S(i,e,n=i){if(function(i,e){return Array.isArray(e)?i.length<=e.length&&Array.from(i).every((n,t)=>{const s=e[t];return y(s)?n===s:n.match(s)}):e.test(i)}(i.value,e))return i;const{value:t,selection:s}=Array.isArray(e)?function(i,e,n){let t=null,s=null;const o=Array.from(i.value).reduce((l,r,u)=>{const a=l+function(i,e,n,t){let s="";for(let o=e.length;o<i.length;o++){const l=i[o],r=t.value[o]===l;if(!y(l)||l===n&&!r)return s;s+=l}return s}(e,l,r,n),m=e[a.length];return y(m)?a+m:r.match(m)?(null===t&&u>=i.selection[0]&&(t=a.length),null===s&&u>=i.selection[1]&&(s=a.length),a+r):a},"");return{value:o,selection:[null!=t?t:o.length,null!=s?s:o.length]}}(i,e,n):function({value:i,selection:e},n){const[t,s]=e;let o=t,l=s;return{value:Array.from(i).reduce((u,d,a)=>{const m=u+d;return t===a&&(o=u.length),s===a&&(l=u.length),m.match(n)?m:u},""),selection:[o,l]}}(i,e);return{selection:s,value:Array.isArray(e)?t.slice(0,e.length):t}}function C(i,e){if(!Array.isArray(e))return i;const[n,t]=i.selection,s=[],o=Array.from(i.value).reduce((l,r,u)=>{const d=e[u];return u===n&&s.push(l.length),u===t&&s.push(l.length),y(d)&&d===r?l:l+r},"");return s.length<2&&s.push(...Array(2-s.length).fill(o.length)),{value:o,selection:[s[0],s[1]]}}class x{constructor(e,n){this.initialElementState=e,this.maskOptions=n,this.value="",this.selection=[0,0];const{value:t,selection:s}=S(e,this.getMaskExpression(e));this.value=t,this.selection=s}addCharacters([e,n],t){const{value:s}=this,o=this.getMaskExpression({value:s.slice(0,e)+t+s.slice(n),selection:[e+t.length,e+t.length]}),l={value:s,selection:[e,n]},r=C(l,o),[u,d]=function({value:i,selection:e},n,t){const[s,o]=e;return{value:i,selection:"replace"===("function"==typeof t?t({value:i,selection:e}):t)?[s,s+n.length]:[s,o]}}(r,t,this.maskOptions.overwriteMode).selection,a=r.value.slice(0,u)+t+r.value.slice(d),m=u+t.length,w=S({value:a,selection:[m,m]},o,l);if(function(i,...e){return e.every(({value:n,selection:t})=>n===i.value&&t[0]===i.selection[0]&&t[1]===i.selection[1])}(this,w))throw new Error("Invalid mask value");this.value=w.value,this.selection=w.selection}deleteCharacters([e,n]){if(e===n||!n)return;const{value:t}=this,s=this.getMaskExpression({value:t.slice(0,e)+t.slice(n),selection:[e,e]}),o={value:t,selection:[e,n]},l=C(o,s),[r,u]=l.selection,a=S({value:l.value.slice(0,r)+l.value.slice(u),selection:[r,r]},s,o);this.value=a.value,this.selection=a.selection}getMaskExpression(e){const{mask:n}=this.maskOptions;return"function"==typeof n?n(e):n}}class A{constructor(e){this.element=e,this.listeners=[]}listen(e,n,t){const s=n;this.element.addEventListener(e,s,t),this.listeners.push(()=>this.element.removeEventListener(e,s))}destroy(){this.listeners.forEach(e=>e())}}function R({value:i,selection:e},n){const[t,s]=e;return t!==s?[t,s]:n?[t,Math.min(s+1,i.length)]:[Math.max(t-1,0),s]}class L extends class{constructor(){this.now=null,this.past=[],this.future=[]}undo(){const e=this.past.pop();e&&this.now&&(this.future.push(this.now),this.updateElement(e,"historyUndo"))}redo(){const e=this.future.pop();e&&this.now&&(this.past.push(this.now),this.updateElement(e,"historyRedo"))}updateHistory(e){if(!this.now)return void(this.now=e);const n=this.now.value!==e.value,t=this.now.selection.some((s,o)=>s!==e.selection[o]);!n&&!t||(n&&(this.past.push(this.now),this.future=[]),this.now=e)}updateElement(e,n){this.now=e,this.updateValue(e.value,{inputType:n,data:null}),this.updateSelectionRange(e.selection)}}{constructor(e,n){super(),this.element=e,this.maskitoOptions=n,this.eventListener=new A(this.element),this.options=Object.assign(Object.assign({},E),this.maskitoOptions),this.conformValueToMask(),this.updateHistory(this.elementState),this.eventListener.listen("keydown",t=>{const{ctrlKey:s,key:o,metaKey:l,shiftKey:r}=t;return l&&r&&"z"===o||s&&"y"===o?(t.preventDefault(),this.redo()):(s||l)&&"z"===o?(t.preventDefault(),this.undo()):void 0}),"onbeforeinput"in e?this.eventListener.listen("beforeinput",t=>{switch(this.updateHistory(this.elementState),t.inputType){case"historyUndo":return t.preventDefault(),this.undo();case"historyRedo":return t.preventDefault(),this.redo();case"deleteContentBackward":case"deleteWordBackward":case"deleteByCut":return this.handleDelete(t,!1);case"deleteContentForward":case"deleteWordForward":return this.handleDelete(t,!0);case"insertFromDrop":return;case"insertLineBreak":return this.handleEnter(t);case"insertFromPaste":case"insertText":default:return this.handleInsert(t,t.data||"")}}):(this.eventListener.listen("keydown",t=>this.handleKeydown(t)),this.eventListener.listen("paste",t=>{var s;return this.handleInsert(t,(null===(s=t.clipboardData)||void 0===s?void 0:s.getData("text/plain"))||"")})),this.eventListener.listen("input",()=>{this.conformValueToMask(),this.updateHistory(this.elementState)})}get elementState(){const{value:e,selectionStart:n,selectionEnd:t}=this.element;return{value:e,selection:[n||0,t||0]}}get isTextArea(){return"TEXTAREA"===this.element.nodeName}destroy(){this.eventListener.destroy()}updateSelectionRange([e,n]){var t,s;(this.element.selectionStart!==e||this.element.selectionEnd!==n)&&(null===(s=(t=this.element).setSelectionRange)||void 0===s||s.call(t,e,n))}updateValue(e,n={inputType:"insertText",data:null}){if(this.element.value!==e){const t="undefined"!=typeof window?window:globalThis;this.element.value=e,(null==t?void 0:t.InputEvent)&&this.element.dispatchEvent(new InputEvent("input",Object.assign(Object.assign({},n),{bubbles:!0,cancelable:!0})))}}handleKeydown(e){const n=e.key;switch(n){case"Backspace":case"Delete":return this.handleDelete(e,"Delete"===n);case"Enter":return this.handleEnter(e)}!function({key:i,ctrlKey:e,metaKey:n,altKey:t}){const s=e||n||t,o=/^.$/u.test(i);return!s&&"Backspace"!==i&&o}(e)||this.handleInsert(e,n)}conformValueToMask(){const e=this.elementState,{elementState:n}=this.options.preprocessor({elementState:e,data:""},"validation"),t=new x(n,this.options),{value:s,selection:o}=this.options.postprocessor(t,e);this.updateValue(s),this.updateSelectionRange(o)}handleDelete(e,n){const t={value:this.elementState.value,selection:R(this.elementState,n)},[s,o]=t.selection,{elementState:l}=this.options.preprocessor({elementState:t,data:""},n?"deleteForward":"deleteBackward"),r=new x(l,this.options),[u,d]=l.selection;r.deleteCharacters([u,d]);const a=this.options.postprocessor(r,t);if(t.value.slice(0,s)+t.value.slice(o)!==a.value)return e.preventDefault(),function(i,...e){return e.every(({value:n})=>n===i.value)}(t,l,r,a)?this.updateSelectionRange(n?[d,d]:[u,u]):(this.updateValue(a.value,{inputType:"inputType"in e?e.inputType:n?"deleteContentForward":"deleteContentBackward",data:null}),this.updateSelectionRange(a.selection),void this.updateHistory(a))}handleInsert(e,n){const t=this.elementState,{elementState:s,data:o=n}=this.options.preprocessor({data:n,elementState:t},"insert"),l=new x(s,this.options);try{l.addCharacters(s.selection,o)}catch(w){return e.preventDefault()}const[r,u]=s.selection,d=s.value.slice(0,r)+n+s.value.slice(u),{value:a,selection:m}=this.options.postprocessor(l,t);d!==a&&(e.preventDefault(),this.updateValue(a,{data:n,inputType:"inputType"in e?e.inputType:"insertText"}),this.updateSelectionRange(m),this.updateHistory({value:a,selection:m}))}handleEnter(e){this.isTextArea&&this.handleInsert(e,"\n")}}function P(...i){return(e,...n)=>i.reduce((t,s)=>Object.assign(Object.assign({},t),s(t,...n)),e)}}}]);